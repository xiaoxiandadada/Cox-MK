% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/main.R
\name{cox_knockoff_analysis}
\alias{cox_knockoff_analysis}
\title{Complete Cox Knockoff Analysis Workflow}
\usage{
cox_knockoff_analysis(
  plink_prefix,
  time,
  status,
  covariates = NULL,
  sample_ids = NULL,
  null_model = NULL,
  gds_file = NULL,
  M = 5,
  fdr = 0.05,
  method = "median",
  output_dir = NULL
)
}
\arguments{
\item{plink_prefix}{Character string. Path prefix for PLINK files (.bed, .bim, .fam)}

\item{time}{Numeric vector. Survival times}

\item{status}{Numeric vector. Censoring indicator (1 = event, 0 = censored)}

\item{covariates}{Data frame or matrix. Covariate data (optional)}

\item{sample_ids}{Character vector. Sample IDs to match with genetic data (optional)}

\item{null_model}{Fitted Cox model object for null hypothesis (optional)}

\item{gds_file}{Character string. Path to pre-generated GDS file with knockoffs (optional)}

\item{M}{Integer. Number of knockoff copies to generate (default: 5)}

\item{fdr}{Numeric. Target false discovery rate (default: 0.05)}

\item{method}{Character. Method for computing W statistics ("median", "difference", "ratio")}

\item{output_dir}{Character string. Directory to save intermediate results (optional)}
}
\value{
List containing:
\itemize{
  \item W_stats - Vector of W statistics for each variant
  \item selected_vars - Indices of selected variants
  \item knockoffs - Generated knockoff matrix (if gds_file not provided)
  \item summary - Summary statistics of the analysis
}
}
\description{
Performs a complete knockoff analysis workflow for survival data including 
knockoff generation, Cox model fitting, association testing, and variable selection.
}
\examples{
\dontrun{
# Complete workflow with PLINK data
result <- cox_knockoff_analysis(
  plink_prefix = "data/genetics",
  time = survival_time,
  status = event_indicator,
  covariates = covariate_matrix,
  M = 5,
  fdr = 0.05
)

# View results
print(result$selected_vars)
print(result$summary)
}
}
