% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/create_knockoffs.R
\name{create_knockoffs}
\alias{create_knockoffs}
\title{Create Model-X Knockoffs}
\usage{
create_knockoffs(
  X,
  pos,
  M = 5,
  corr_max = 0.75,
  maxN.neighbor = Inf,
  maxBP.neighbor = 1e+05,
  n.AL = floor(10 * nrow(X)^(1/3) * log(nrow(X))),
  thres.ultrarare = 25,
  R2.thres = 1,
  prob.eps = 1e-12,
  irlba.maxit = 1500,
  bigmemory = FALSE
)
}
\arguments{
\item{X}{A sparse matrix (n x p) of genotype data where n is the number of 
samples and p is the number of SNPs. Should be of class dgCMatrix.}

\item{pos}{A numeric vector of SNP positions (in base pairs).}

\item{M}{Number of knockoff copies to generate. Default is 5, but users can 
specify any positive integer. More knockoff copies may improve power but 
increase computational cost.}

\item{corr_max}{Maximum correlation threshold for clustering (default: 0.75).}

\item{maxN.neighbor}{Maximum number of neighbors to consider (default: Inf).}

\item{maxBP.neighbor}{Maximum base pair distance for neighbors (default: 1e5).}

\item{n.AL}{Number of samples for adaptive lasso (default: automatic).}

\item{thres.ultrarare}{Threshold for ultra-rare variants (default: 25).}

\item{R2.thres}{R-squared threshold (default: 1).}

\item{prob.eps}{Minimum probability value (default: 1e-12).}

\item{irlba.maxit}{Maximum iterations for irlba (default: 1500).}

\item{bigmemory}{Whether to use big.matrix for storage (default: FALSE).}
}
\value{
A list of M matrices, each containing knockoff variables.
}
\description{
Generate knockoff variables for genotype data using the Model-X knockoff 
method with leveraging scores and clustering.
}
\examples{
\dontrun{
# Load example data
data(example_genotypes)
data(example_positions)

# Create knockoffs with different numbers of copies
knockoffs_3 <- create_knockoffs(example_genotypes, example_positions, M = 3)
knockoffs_5 <- create_knockoffs(example_genotypes, example_positions, M = 5)
knockoffs_10 <- create_knockoffs(example_genotypes, example_positions, M = 10)
}

}
